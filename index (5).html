<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Hindustan Olympiad</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--saffron:#FF6B1A;--navy:#0A1628;--navy-mid:#112240;--navy-card:#162B4D;--green:#06D6A0;--gold:#FFD700;--white:#F0F4FF;--muted:#8899BB;--danger:#EF476F}
body{font-family:'Sora',sans-serif;background:var(--navy);color:var(--white);overflow-x:hidden}
.splash{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background:radial-gradient(ellipse at 50% 0%,#1a3a6e,var(--navy));position:relative;overflow:hidden}
.splash-ring{position:absolute;border-radius:50%;border:1px solid rgba(255,107,26,.15);animation:pulse 3s ease-in-out infinite}
.splash-ring:nth-child(1){width:300px;height:300px}.splash-ring:nth-child(2){width:500px;height:500px;animation-delay:.5s}.splash-ring:nth-child(3){width:700px;height:700px;animation-delay:1s}
@keyframes pulse{0%,100%{transform:scale(1);opacity:.3}50%{transform:scale(1.05);opacity:.6}}
.splash-logo{width:100px;height:100px;border-radius:24px;background:linear-gradient(135deg,var(--saffron),#c1440e);display:flex;align-items:center;justify-content:center;font-size:48px;box-shadow:0 20px 60px rgba(255,107,26,.4);animation:logoIn .8s ease-out;margin-bottom:24px}
@keyframes logoIn{from{transform:scale(.5) rotate(-10deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}
.splash-title{font-size:32px;font-weight:800;text-align:center;line-height:1.2;background:linear-gradient(135deg,var(--gold),#FF8C42);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.splash-sub{color:var(--muted);font-size:14px;margin-top:8px;letter-spacing:3px;text-transform:uppercase}
.splash-bar-wrap{width:200px;height:3px;background:rgba(255,255,255,.1);border-radius:99px;margin-top:40px;overflow:hidden}
.splash-bar{height:100%;background:linear-gradient(90deg,var(--saffron),var(--gold));border-radius:99px;animation:load 2.3s ease-in-out forwards}
@keyframes load{from{width:0%}to{width:100%}}
.auth-wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;background:radial-gradient(ellipse at 30% 50%,#1a3a6e,var(--navy));padding:20px}
.auth-card{background:var(--navy-mid);border:1px solid rgba(255,107,26,.2);border-radius:24px;padding:40px;width:100%;max-width:420px;box-shadow:0 40px 80px rgba(0,0,0,.4)}
.auth-header{text-align:center;margin-bottom:32px}.auth-logo{font-size:40px;margin-bottom:12px}
.auth-title{font-size:24px;font-weight:700;color:var(--white)}.auth-sub{color:var(--muted);font-size:13px;margin-top:6px}
.tab-row{display:flex;background:var(--navy);border-radius:12px;padding:4px;margin-bottom:28px;gap:4px}
.tab-btn{flex:1;padding:10px;border:none;border-radius:8px;font-family:'Sora',sans-serif;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s}
.tab-btn.active{background:linear-gradient(135deg,var(--saffron),#c1440e);color:white}.tab-btn.inactive{background:transparent;color:var(--muted)}
.field-label{font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.field{width:100%;padding:14px 16px;background:var(--navy);border:1px solid rgba(255,255,255,.1);border-radius:12px;color:var(--white);font-family:'Sora',sans-serif;font-size:15px;outline:none;transition:border-color .2s;margin-bottom:16px}
.field:focus{border-color:var(--saffron)}.field::placeholder{color:var(--muted)}
.btn-primary{width:100%;padding:16px;background:linear-gradient(135deg,var(--saffron),#c1440e);border:none;border-radius:12px;color:white;font-family:'Sora',sans-serif;font-size:15px;font-weight:700;cursor:pointer;transition:all .2s}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(255,107,26,.4)}
.home{min-height:100vh;background:var(--navy);padding-bottom:40px}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;background:var(--navy-mid);border-bottom:1px solid rgba(255,255,255,.06)}
.topbar-logo{display:flex;align-items:center;gap:10px}
.topbar-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--saffron),#c1440e);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px}
.topbar-name{font-size:16px;font-weight:700;background:linear-gradient(135deg,var(--gold),#FF8C42);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.avatar{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--saffron),#9b5de5);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700}
.logout-btn{background:rgba(255,107,26,.1);border:1px solid rgba(255,107,26,.3);color:var(--saffron);padding:6px 14px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;font-family:'Sora',sans-serif}
.hero-banner{margin:24px;background:linear-gradient(135deg,#1a3a6e,#162B4D);border-radius:20px;padding:28px;border:1px solid rgba(255,107,26,.2)}
.hero-tag{display:inline-block;background:rgba(255,215,0,.15);color:var(--gold);font-size:11px;font-weight:700;padding:4px 12px;border-radius:99px;letter-spacing:2px;text-transform:uppercase;border:1px solid rgba(255,215,0,.3);margin-bottom:12px}
.hero-title{font-size:22px;font-weight:800;line-height:1.3;margin-bottom:8px}
.hero-sub{color:var(--muted);font-size:13px;line-height:1.6}
.hero-stats{display:flex;gap:24px;margin-top:20px}.stat-item{text-align:center}
.stat-num{font-size:22px;font-weight:800;color:var(--saffron)}.stat-lbl{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:1px}
.section-title{padding:0 24px;margin-bottom:16px;font-size:18px;font-weight:700;display:flex;align-items:center;gap:8px}
.class-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:0 24px;margin-bottom:32px}
@media(max-width:600px){.class-grid{grid-template-columns:repeat(3,1fr)}}
.class-card{background:var(--navy-card);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px 12px;text-align:center;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.class-card:hover{transform:translateY(-3px);border-color:rgba(255,107,26,.4);box-shadow:0 12px 30px rgba(0,0,0,.3)}
.class-num{font-size:20px;font-weight:800}.class-label{font-size:11px;color:var(--muted)}
.class-badge{position:absolute;top:8px;right:8px;font-size:10px;background:rgba(255,215,0,.2);color:var(--gold);padding:2px 6px;border-radius:99px;font-weight:600}
.setup-wrap{min-height:100vh;background:var(--navy);padding-bottom:60px}
.setup-header{display:flex;align-items:center;gap:12px;padding:20px 24px;background:var(--navy-mid);border-bottom:1px solid rgba(255,255,255,.06)}
.back-btn{width:36px;height:36px;border-radius:10px;background:rgba(255,255,255,.06);border:none;color:var(--white);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center}
.setup-title{font-size:18px;font-weight:700}.setup-sub{color:var(--muted);font-size:12px}
.option-card{background:var(--navy-card);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:20px;cursor:pointer;transition:all .2s;text-align:center;margin-bottom:14px}
.option-card:hover{transform:translateY(-3px)}.option-icon{font-size:32px;margin-bottom:10px}
.option-name{font-size:16px;font-weight:700;margin-bottom:4px}.option-desc{font-size:11px;color:var(--muted);line-height:1.5}
.subject-list{display:flex;flex-direction:column;gap:12px;padding:24px}
.subject-item{background:var(--navy-card);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:16px 20px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:14px}
.subject-item:hover{border-color:rgba(255,107,26,.4);transform:translateX(4px)}.subject-item.selected{border-color:var(--saffron);background:rgba(255,107,26,.08)}
.subject-name{font-size:14px;font-weight:600;flex:1}
.level-row{display:flex;flex-direction:column;gap:14px;padding:24px}
.level-card{background:var(--navy-card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:20px 22px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:16px}
.level-card:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(0,0,0,.3)}
.level-bar{width:4px;height:40px;border-radius:4px;flex-shrink:0}.level-info{flex:1}
.level-title{font-size:15px;font-weight:700}.level-desc{font-size:12px;color:var(--muted);margin-top:3px}
.level-q{font-size:12px;font-weight:600;color:var(--gold);background:rgba(255,215,0,.1);padding:3px 10px;border-radius:99px}
.gen-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80vh;padding:40px;text-align:center}
.gen-icon{font-size:56px;animation:spin 2s linear infinite;margin-bottom:20px}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.exam-wrap{min-height:100vh;background:var(--navy);display:flex;flex-direction:column}
.exam-topbar{padding:16px 20px;background:var(--navy-mid);border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between}
.timer{display:flex;align-items:center;gap:8px;background:var(--navy-card);border:1px solid rgba(255,107,26,.3);padding:8px 16px;border-radius:10px}
.timer-val{font-size:15px;font-weight:700;font-variant-numeric:tabular-nums}.timer-val.danger{color:var(--danger)}
.progress-row{height:3px;background:rgba(255,255,255,.08)}.progress-fill{height:100%;background:linear-gradient(90deg,var(--saffron),var(--gold));transition:width .3s}
.exam-body{flex:1;padding:24px 20px;max-width:720px;margin:0 auto;width:100%}
.q-num{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-bottom:12px}
.q-text{font-size:17px;font-weight:600;line-height:1.6;margin-bottom:24px}
.options-list{display:flex;flex-direction:column;gap:10px;margin-bottom:28px}
.option-btn{background:var(--navy-card);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:16px 18px;cursor:pointer;text-align:left;font-family:'Sora',sans-serif;font-size:14px;color:var(--white);display:flex;align-items:center;gap:14px;transition:all .15s;width:100%}
.option-btn:hover{border-color:rgba(255,107,26,.4)}.option-btn.selected{border-color:var(--saffron);background:rgba(255,107,26,.1)}
.option-btn.correct{border-color:var(--green);background:rgba(6,214,160,.1)}.option-btn.wrong{border-color:var(--danger);background:rgba(239,71,111,.1)}
.opt-label{width:28px;height:28px;border-radius:8px;border:1px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0}
.option-btn.selected .opt-label{background:var(--saffron);border-color:var(--saffron)}
.option-btn.correct .opt-label{background:var(--green);border-color:var(--green);color:var(--navy)}
.option-btn.wrong .opt-label{background:var(--danger);border-color:var(--danger)}
.nav-row{display:flex;gap:12px;align-items:center;justify-content:space-between}
.nav-btn{padding:12px 24px;border-radius:12px;border:none;font-family:'Sora',sans-serif;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s}
.nav-btn.prev{background:var(--navy-card);border:1px solid rgba(255,255,255,.1);color:var(--muted)}
.nav-btn.next{background:linear-gradient(135deg,var(--saffron),#c1440e);color:white;padding:12px 32px}
.nav-btn:disabled{opacity:.4;cursor:not-allowed}
.q-dots{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:20px}
.q-dot{width:28px;height:28px;border-radius:7px;font-size:11px;font-weight:700;display:flex;align-items:center;justify-content:center;cursor:pointer;border:none;font-family:'Sora',sans-serif;transition:all .15s}
.q-dot.answered{background:rgba(255,107,26,.3);color:var(--saffron)}.q-dot.current{background:var(--saffron);color:white}.q-dot.unanswered{background:rgba(255,255,255,.06);color:var(--muted)}
.results-wrap{min-height:100vh;background:var(--navy);padding-bottom:60px}
.results-hero{padding:40px 24px;text-align:center;background:linear-gradient(180deg,var(--navy-mid),var(--navy));border-bottom:1px solid rgba(255,255,255,.06)}
.score-ring{width:140px;height:140px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;position:relative}
.score-ring-inner{width:110px;height:110px;border-radius:50%;background:var(--navy-mid);display:flex;flex-direction:column;align-items:center;justify-content:center;border:4px solid var(--saffron)}
.score-big{font-size:28px;font-weight:800}.score-total{font-size:12px;color:var(--muted)}
.results-grade{font-size:32px;font-weight:800;margin-bottom:8px}
.results-msg{font-size:14px;color:var(--muted);max-width:280px;margin:0 auto}
.results-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;padding:0 24px;margin:24px 0}
.r-stat{background:var(--navy-card);border-radius:14px;padding:16px;text-align:center;border:1px solid rgba(255,255,255,.06)}
.r-stat-num{font-size:20px;font-weight:800}.r-stat-lbl{font-size:11px;color:var(--muted);margin-top:4px}
.review-section{padding:0 24px}
.review-q{background:var(--navy-card);border-radius:16px;padding:18px;margin-bottom:14px;border:1px solid rgba(255,255,255,.06)}
.review-q-top{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:12px}
.review-badge{font-size:11px;font-weight:700;padding:3px 10px;border-radius:99px;flex-shrink:0}
.badge-correct{background:rgba(6,214,160,.15);color:var(--green)}.badge-wrong{background:rgba(239,71,111,.15);color:var(--danger)}.badge-skip{background:rgba(255,255,255,.08);color:var(--muted)}
.review-q-text{font-size:14px;line-height:1.6;flex:1}
.review-correct-ans{color:var(--green);font-size:12px;margin-top:4px}.review-wrong-ans{color:var(--danger);font-size:12px}
.review-exp{margin-top:10px;padding:10px 14px;background:rgba(255,215,0,.05);border-left:3px solid var(--gold);border-radius:0 8px 8px 0;font-size:12px;color:var(--muted);line-height:1.6}
.chat-fab{position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--saffron),#c1440e);border:none;cursor:pointer;font-size:24px;box-shadow:0 8px 24px rgba(255,107,26,.4);display:flex;align-items:center;justify-content:center;z-index:100}
.chat-panel{position:fixed;bottom:90px;right:24px;width:320px;max-height:480px;background:var(--navy-mid);border:1px solid rgba(255,255,255,.1);border-radius:20px;display:flex;flex-direction:column;overflow:hidden;z-index:100;box-shadow:0 24px 60px rgba(0,0,0,.5)}
@media(max-width:400px){.chat-panel{width:calc(100vw - 48px)}}
.chat-head{padding:16px 18px;border-bottom:1px solid rgba(255,255,255,.08);display:flex;align-items:center;justify-content:space-between}
.chat-title{font-size:14px;font-weight:700;display:flex;align-items:center;gap:8px}
.ai-dot{width:8px;height:8px;border-radius:50%;background:var(--green);animation:blink 1.5s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.close-btn{background:none;border:none;color:var(--muted);cursor:pointer;font-size:18px}
.chat-msgs{flex:1;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:10px}
.chat-msg{max-width:85%;padding:10px 13px;border-radius:14px;font-size:13px;line-height:1.6}
.chat-msg.user{background:rgba(255,107,26,.2);align-self:flex-end}.chat-msg.ai{background:var(--navy-card);align-self:flex-start}
.chat-input-row{display:flex;gap:8px;padding:12px;border-top:1px solid rgba(255,255,255,.08)}
.chat-input{flex:1;background:var(--navy);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 14px;color:var(--white);font-family:'Sora',sans-serif;font-size:13px;outline:none}
.chat-input:focus{border-color:var(--saffron)}
.chat-send{width:36px;height:36px;background:linear-gradient(135deg,var(--saffron),#c1440e);border:none;border-radius:10px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.start-btn-wrap{padding:24px}
.error-msg{color:var(--danger);font-size:13px;text-align:center;padding:10px}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState, useEffect, useRef} = React;

const SUBJECTS_1_10 = ["Mathematics","Science","English","Logical Reasoning","General Knowledge"];
const STREAMS = {
  "Science Stream":{icon:"‚öóÔ∏è",color:"#00b4d8",subjects:["Physics (Mechanics, Thermodynamics, Waves)","Chemistry (Atomic Structure, Bonding, Organic)","Mathematics","Biology"]},
  "Commerce Stream":{icon:"üìä",color:"#f77f00",subjects:["Accountancy","Economics","Business Studies"]},
  "Humanities Stream":{icon:"üèõÔ∏è",color:"#9b5de5",subjects:["History","Political Science","Geography"]},
};
const COMMON_11_12 = ["English (Grammar, Vocabulary, Comprehension)","Logical Reasoning"];
const LEVELS = [{id:1,label:"Level 1",tag:"Beginner",color:"#06d6a0"},{id:2,label:"Level 2",tag:"Intermediate",color:"#ffd166"},{id:3,label:"Level 3",tag:"Advanced",color:"#ef476f"}];
const EXAM_DURATION = 7200;

async function callClaude(userMessage, system="") {
  const res = await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1000,system,messages:[{role:"user",content:userMessage}]})});
  const data = await res.json();
  return data.content?.map(b=>b.text||"").join("")||"";
}

async function generateQuestions(cls, subject, level, stream=null) {
  const ld = ["Beginner","Intermediate","Advanced"][level-1];
  const ctx = stream?`Stream: ${stream}, `:"";
  const prompt = `Generate 20 NCERT-based MCQ questions for Class: ${cls}, ${ctx}Subject: ${subject}, Level: ${ld}
Return ONLY valid JSON array: [{"q":"question","options":["A) opt","B) opt","C) opt","D) opt"],"answer":"A","explanation":"brief"},...]
Rules: NCERT aligned, ${ld} difficulty, 4 options A B C D, answer is just the letter.`;
  const raw = await callClaude(prompt,"You are an expert Indian education content creator for Hindustan Olympiad. Output only valid JSON.");
  try {
    const clean = raw.replace(/```json|```/g,"").trim();
    return JSON.parse(clean.slice(clean.indexOf("["),clean.lastIndexOf("]")+1));
  } catch {
    return Array.from({length:20},(_,i)=>({q:`${subject} Q${i+1}: What is the fundamental concept?`,options:["A) Option Alpha","B) Option Beta","C) Option Gamma","D) Option Delta"],answer:"A",explanation:`Basic ${subject} NCERT concept.`}));
  }
}

function Splash({onDone}) {
  useEffect(()=>{const t=setTimeout(onDone,2500);return()=>clearTimeout(t);},[]);
  return (
    <div className="splash">
      {[1,2,3].map(i=><div key={i} className="splash-ring"/>)}
      <div className="splash-logo">üèÖ</div>
      <div className="splash-title">Hindustan<br/>Olympiad</div>
      <div className="splash-sub">Excellence in Education</div>
      <div className="splash-bar-wrap"><div className="splash-bar"/></div>
    </div>
  );
}

function Auth({onAuth}) {
  const [tab,setTab]=useState("login");
  const [name,setName]=useState("");
  const [email,setEmail]=useState("");
  const [pass,setPass]=useState("");
  const [err,setErr]=useState("");
  const submit=()=>{
    if(!email||!pass){setErr("Please fill all fields");return;}
    if(tab==="signup"&&!name){setErr("Enter your name");return;}
    if(pass.length<4){setErr("Password must be 4+ characters");return;}
    onAuth({name:name||email.split("@")[0],email});
  };
  return (
    <div className="auth-wrap">
      <div className="auth-card">
        <div className="auth-header">
          <div className="auth-logo">üèÖ</div>
          <div className="auth-title">Hindustan Olympiad</div>
          <div className="auth-sub">Your path to academic excellence</div>
        </div>
        <div className="tab-row">
          {["login","signup"].map(t=><button key={t} className={`tab-btn ${tab===t?"active":"inactive"}`} onClick={()=>{setTab(t);setErr("");}}>{t==="login"?"Login":"Sign Up"}</button>)}
        </div>
        {tab==="signup"&&<><div className="field-label">Full Name</div><input className="field" placeholder="Arjun Sharma" value={name} onChange={e=>setName(e.target.value)}/></>}
        <div className="field-label">Email</div>
        <input className="field" type="email" placeholder="student@example.com" value={email} onChange={e=>setEmail(e.target.value)}/>
        <div className="field-label">Password</div>
        <input className="field" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value={pass} onChange={e=>setPass(e.target.value)} onKeyDown={e=>e.key==="Enter"&&submit()}/>
        {err&&<div className="error-msg">{err}</div>}
        <button className="btn-primary" onClick={submit}>{tab==="login"?"Login to Continue":"Create Account"}</button>
      </div>
    </div>
  );
}

function Home({user,onSelectClass,onLogout}) {
  const colors=["#FF6B1A","#06D6A0","#FFD700","#9B5DE5","#00B4D8","#F77F00","#EF476F","#06D6A0","#FF6B1A","#FFD700","#9B5DE5","#00B4D8"];
  return (
    <div className="home">
      <div className="topbar">
        <div className="topbar-logo">
          <div className="topbar-icon">üèÖ</div>
          <div className="topbar-name">Hindustan Olympiad</div>
        </div>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div className="avatar">{user.name[0].toUpperCase()}</div>
          <button className="logout-btn" onClick={onLogout}>Logout</button>
        </div>
      </div>
      <div className="hero-banner">
        <div className="hero-tag">üåü Official Platform</div>
        <div className="hero-title">Welcome back, {user.name.split(" ")[0]}! üéì</div>
        <div className="hero-sub">AI-powered NCERT-aligned exam preparation for Olympiad success.</div>
        <div className="hero-stats">
          <div className="stat-item"><div className="stat-num">12</div><div className="stat-lbl">Classes</div></div>
          <div className="stat-item"><div className="stat-num">AI</div><div className="stat-lbl">Powered</div></div>
          <div className="stat-item"><div className="stat-num">100+</div><div className="stat-lbl">Q/Level</div></div>
          <div className="stat-item"><div className="stat-num">2h</div><div className="stat-lbl">Duration</div></div>
        </div>
      </div>
      <div className="section-title">üìö Classes 1‚Äì10</div>
      <div className="class-grid">
        {Array.from({length:10},(_,i)=>i+1).map(cls=>(
          <div key={cls} className="class-card" onClick={()=>onSelectClass(cls)}>
            <div className="class-num" style={{color:colors[cls-1]}}>Class {cls}</div>
            <div className="class-label">Std {cls}</div>
          </div>
        ))}
      </div>
      <div className="section-title">üéØ Classes 11‚Äì12</div>
      <div className="class-grid" style={{gridTemplateColumns:"1fr 1fr"}}>
        {[11,12].map(cls=>(
          <div key={cls} className="class-card" onClick={()=>onSelectClass(cls)}>
            <div className="class-badge">Advanced</div>
            <div className="class-num" style={{color:colors[cls-1],fontSize:24}}>Class {cls}</div>
            <div className="class-label">Senior Secondary</div>
          </div>
        ))}
      </div>
    </div>
  );
}

function StreamSelect({cls,onBack,onSelect}) {
  return (
    <div className="setup-wrap">
      <div className="setup-header">
        <button className="back-btn" onClick={onBack}>‚Üê</button>
        <div><div className="setup-title">Class {cls} ‚Äî Choose Stream</div><div className="setup-sub">Select your academic stream</div></div>
      </div>
      <div style={{padding:24}}>
        <div style={{marginBottom:16,color:"var(--muted)",fontSize:13}}>‚ö° Common for all streams: English & Logical Reasoning</div>
        {Object.entries(STREAMS).map(([stream,info])=>(
          <div key={stream} className="option-card" onClick={()=>onSelect(stream)}>
            <div className="option-icon">{info.icon}</div>
            <div className="option-name" style={{color:info.color}}>{stream}</div>
            <div className="option-desc">{info.subjects.join(" ¬∑ ")}</div>
            <div style={{marginTop:8,fontSize:11,color:"var(--muted)"}}>+ English ¬∑ Logical Reasoning (Common)</div>
          </div>
        ))}
      </div>
    </div>
  );
}

function SubjectSelect({cls,stream,onBack,onSelect}) {
  const [sel,setSel]=useState(null);
  const subjects = stream?[...(STREAMS[stream]?.subjects||[]),...COMMON_11_12]:SUBJECTS_1_10;
  const icons={"Mathematics":"üìê","Science":"üî¨","English":"üìñ","Logical Reasoning":"üß©","General Knowledge":"üåç",
    "Physics (Mechanics, Thermodynamics, Waves)":"‚ö°","Chemistry (Atomic Structure, Bonding, Organic)":"‚öóÔ∏è","Biology":"üåø",
    "Accountancy":"üìã","Economics":"üìà","Business Studies":"üíº","History":"üèõÔ∏è","Political Science":"‚öñÔ∏è","Geography":"üó∫Ô∏è",
    "English (Grammar, Vocabulary, Comprehension)":"üìñ"};
  return (
    <div className="setup-wrap">
      <div className="setup-header">
        <button className="back-btn" onClick={onBack}>‚Üê</button>
        <div><div className="setup-title">Select Subject</div><div className="setup-sub">Class {cls}{stream?` ¬∑ ${stream.split(" ")[0]}`:""}</div></div>
      </div>
      <div className="subject-list">
        {subjects.map(sub=>(
          <div key={sub} className={`subject-item${sel===sub?" selected":""}`} onClick={()=>setSel(sub)}>
            <div style={{fontSize:22}}>{icons[sub]||"üìö"}</div>
            <div className="subject-name">{sub}</div>
            {COMMON_11_12.includes(sub)&&stream&&<div style={{fontSize:10,background:"rgba(255,215,0,.15)",color:"var(--gold)",padding:"2px 8px",borderRadius:99}}>Common</div>}
            {sel===sub&&<div style={{fontSize:18}}>‚úì</div>}
          </div>
        ))}
      </div>
      {sel&&<div className="start-btn-wrap"><button className="btn-primary" onClick={()=>onSelect(sel)}>Continue ‚Üí</button></div>}
    </div>
  );
}

function LevelSelect({cls,subject,onBack,onSelect}) {
  const descs=["Foundational NCERT concepts. Build your base.","Application-based moderate complexity.","Higher-order thinking & HOTS. Olympiad-level!"];
  return (
    <div className="setup-wrap">
      <div className="setup-header">
        <button className="back-btn" onClick={onBack}>‚Üê</button>
        <div><div className="setup-title">Select Difficulty Level</div><div className="setup-sub">{subject} ¬∑ Class {cls}</div></div>
      </div>
      <div className="level-row">
        {LEVELS.map((lvl,i)=>(
          <div key={lvl.id} className="level-card" onClick={()=>onSelect(lvl.id)}>
            <div className="level-bar" style={{background:lvl.color}}/>
            <div className="level-info">
              <div className="level-title">{lvl.label} <span style={{color:lvl.color}}>‚Äî {lvl.tag}</span></div>
              <div className="level-desc">{descs[i]}</div>
            </div>
            <div className="level-q">20 MCQs</div>
          </div>
        ))}
      </div>
      <div style={{margin:"0 24px",padding:16,background:"rgba(255,215,0,.04)",borderRadius:12,border:"1px solid rgba(255,215,0,.1)",fontSize:12,color:"var(--muted)"}}>
        ‚è±Ô∏è Duration: 2 Hours &nbsp;|&nbsp; üìù 20 MCQ Questions &nbsp;|&nbsp; üéØ NCERT Curriculum
      </div>
    </div>
  );
}

function Generating({cls,subject,level}) {
  const msgs=["Analyzing NCERT curriculum‚Ä¶","Crafting questions with AI‚Ä¶","Calibrating difficulty‚Ä¶","Almost ready!"];
  const [mi,setMi]=useState(0);
  useEffect(()=>{const t=setInterval(()=>setMi(i=>(i+1)%msgs.length),800);return()=>clearInterval(t);},[]);
  return (
    <div style={{minHeight:"100vh",background:"var(--navy)"}}>
      <div className="gen-screen">
        <div className="gen-icon">‚öôÔ∏è</div>
        <div style={{fontSize:20,fontWeight:700,marginBottom:8}}>Generating Your Exam</div>
        <div style={{color:"var(--muted)",fontSize:13,marginBottom:8}}>{msgs[mi]}</div>
        <div style={{color:"var(--muted)",fontSize:12}}>{subject} ¬∑ Class {cls} ¬∑ Level {level}</div>
      </div>
    </div>
  );
}

function Exam({questions,cls,subject,onFinish}) {
  const [current,setCurrent]=useState(0);
  const [answers,setAnswers]=useState({});
  const [timeLeft,setTimeLeft]=useState(EXAM_DURATION);
  useEffect(()=>{
    const t=setInterval(()=>setTimeLeft(prev=>{if(prev<=1){onFinish(answers,questions);return 0;}return prev-1;}),1000);
    return()=>clearInterval(t);
  },[]);
  const fmt=s=>`${String(Math.floor(s/3600)).padStart(2,"0")}:${String(Math.floor((s%3600)/60)).padStart(2,"0")}:${String(s%60).padStart(2,"0")}`;
  const q=questions[current]; const answered=answers[current]; const danger=timeLeft<600;
  const handleAnswer=opt=>{if(!answers[current])setAnswers(prev=>({...prev,[current]:opt}));};
  return (
    <div className="exam-wrap">
      <div className="exam-topbar">
        <div style={{fontSize:13,fontWeight:600,color:"var(--muted)"}}>Class <span style={{color:"var(--white)"}}>{cls}</span> ¬∑ <span style={{color:"var(--white)"}}>{subject}</span></div>
        <div className="timer"><span>‚è±Ô∏è</span><div className={`timer-val${danger?" danger":""}`}>{fmt(timeLeft)}</div></div>
      </div>
      <div className="progress-row"><div className="progress-fill" style={{width:`${((current+1)/questions.length)*100}%`}}/></div>
      <div className="exam-body">
        <div className="q-dots">
          {questions.map((_,i)=><button key={i} className={`q-dot${i===current?" current":answers[i]?" answered":" unanswered"}`} onClick={()=>setCurrent(i)}>{i+1}</button>)}
        </div>
        <div className="q-num">Question {current+1} of {questions.length}</div>
        <div className="q-text">{q.q}</div>
        <div className="options-list">
          {q.options.map((opt,i)=>{
            const letter=opt[0]; let cls2="";
            if(answered){cls2=letter===q.answer?"correct":letter===answered?"wrong":"";}
            return (
              <button key={i} className={`option-btn${answered===letter?" selected":""}${cls2?" "+cls2:""}`} onClick={()=>handleAnswer(letter)}>
                <div className="opt-label">{letter}</div><span>{opt.slice(3)}</span>
              </button>
            );
          })}
        </div>
        <div className="nav-row">
          <button className="nav-btn prev" disabled={current===0} onClick={()=>setCurrent(c=>c-1)}>‚Üê Prev</button>
          <div style={{fontSize:12,color:"var(--muted)"}}>{Object.keys(answers).length}/{questions.length}</div>
          {current<questions.length-1
            ?<button className="nav-btn next" onClick={()=>setCurrent(c=>c+1)}>Next ‚Üí</button>
            :<button className="nav-btn next" onClick={()=>onFinish(answers,questions)}>Submit ‚úì</button>}
        </div>
      </div>
    </div>
  );
}

function Results({questions,answers,onHome,onRetry}) {
  const correct=questions.filter((q,i)=>answers[i]===q.answer).length;
  const wrong=questions.filter((q,i)=>answers[i]&&answers[i]!==q.answer).length;
  const skipped=questions.length-correct-wrong;
  const pct=Math.round((correct/questions.length)*100);
  const grade=pct>=90?"üèÜ Outstanding":pct>=75?"ü•á Excellent":pct>=60?"ü•à Good":pct>=40?"ü•â Average":"üìñ Keep Practicing";
  const msg=pct>=75?"Brilliant! You're on track for the Olympiad.":pct>=50?"Good effort! Review the explanations.":"Don't give up! Every attempt makes you stronger.";
  return (
    <div className="results-wrap">
      <div className="results-hero">
        <div className="score-ring">
          <div className="score-ring-inner">
            <div className="score-big">{correct}/{questions.length}</div>
            <div className="score-total">{pct}% Score</div>
          </div>
        </div>
        <div className="results-grade">{grade}</div>
        <div className="results-msg">{msg}</div>
      </div>
      <div className="results-stats">
        <div className="r-stat"><div className="r-stat-num" style={{color:"var(--green)"}}>{correct}</div><div className="r-stat-lbl">Correct</div></div>
        <div className="r-stat"><div className="r-stat-num" style={{color:"var(--danger)"}}>{wrong}</div><div className="r-stat-lbl">Wrong</div></div>
        <div className="r-stat"><div className="r-stat-num" style={{color:"var(--muted)"}}>{skipped}</div><div className="r-stat-lbl">Skipped</div></div>
      </div>
      <div style={{display:"flex",gap:12,padding:"0 24px",marginBottom:24}}>
        <button className="btn-primary" style={{flex:1}} onClick={onRetry}>üîÅ Retry</button>
        <button className="btn-primary" style={{flex:1,background:"var(--navy-card)",border:"1px solid rgba(255,255,255,.1)"}} onClick={onHome}>üè† Home</button>
      </div>
      <div style={{padding:"0 24px",marginBottom:14,fontSize:18,fontWeight:700}}>üìã Review Answers</div>
      <div className="review-section">
        {questions.map((q,i)=>{
          const ua=answers[i];const ok=ua===q.answer;const skip=!ua;
          return (
            <div key={i} className="review-q">
              <div className="review-q-top">
                <div className="review-q-text"><strong>Q{i+1}.</strong> {q.q}</div>
                <div className={`review-badge ${skip?"badge-skip":ok?"badge-correct":"badge-wrong"}`}>{skip?"Skipped":ok?"Correct":"Wrong"}</div>
              </div>
              {!skip&&<div style={{marginTop:8}}>{!ok&&<div className="review-wrong-ans">‚ùå Your: {ua}</div>}<div className="review-correct-ans">‚úì Correct: {q.answer}</div></div>}
              <div className="review-exp">üí° {q.explanation}</div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

function ChatBot({subject,cls}) {
  const [open,setOpen]=useState(false);
  const [msgs,setMsgs]=useState([{role:"ai",text:`Hi! I'm your AI tutor for ${subject}. Ask me anything! üéì`}]);
  const [input,setInput]=useState("");
  const [loading,setLoading]=useState(false);
  const bottomRef=useRef(null);
  useEffect(()=>{bottomRef.current?.scrollIntoView({behavior:"smooth"});},[msgs]);
  const send=async()=>{
    if(!input.trim()||loading)return;
    const q=input.trim();setInput("");setLoading(true);
    setMsgs(prev=>[...prev,{role:"user",text:q},{role:"ai",text:"Thinking‚Ä¶"}]);
    const ans=await callClaude(q,`You are a helpful Indian educational AI tutor for Class ${cls} ${subject} (NCERT). Give clear concise answers under 150 words.`);
    setMsgs(prev=>[...prev.slice(0,-1),{role:"ai",text:ans}]);
    setLoading(false);
  };
  return (
    <>
      <button className="chat-fab" onClick={()=>setOpen(o=>!o)}>{open?"‚úï":"ü§ñ"}</button>
      {open&&(
        <div className="chat-panel">
          <div className="chat-head">
            <div className="chat-title"><div className="ai-dot"/>Ask with AI</div>
            <button className="close-btn" onClick={()=>setOpen(false)}>‚úï</button>
          </div>
          <div className="chat-msgs">
            {msgs.map((m,i)=><div key={i} className={`chat-msg ${m.role}`}>{m.text}</div>)}
            <div ref={bottomRef}/>
          </div>
          <div className="chat-input-row">
            <input className="chat-input" placeholder="Ask your doubt‚Ä¶" value={input} onChange={e=>setInput(e.target.value)} onKeyDown={e=>e.key==="Enter"&&send()}/>
            <button className="chat-send" onClick={send}>‚û§</button>
          </div>
        </div>
      )}
    </>
  );
}

function App() {
  const [screen,setScreen]=useState("splash");
  const [user,setUser]=useState(null);
  const [cls,setCls]=useState(null);
  const [stream,setStream]=useState(null);
  const [subject,setSubject]=useState(null);
  const [level,setLevel]=useState(null);
  const [questions,setQuestions]=useState([]);
  const [answers,setAnswers]=useState({});
  const go=s=>setScreen(s);
  const selectClass=c=>{setCls(c);setStream(null);setSubject(null);setLevel(null);go(c>=11?"stream":"subject");};
  const selectStream=s=>{setStream(s);go("subject");};
  const selectSubject=s=>{setSubject(s);go("level");};
  const selectLevel=async l=>{
    setLevel(l);go("generating");
    const qs=await generateQuestions(cls,subject,l,stream);
    setQuestions(qs);setAnswers({});go("exam");
  };
  const finish=(ans)=>{setAnswers(ans);go("results");};
  const retry=()=>{setAnswers({});selectLevel(level);};
  const goHome=()=>{setCls(null);setStream(null);setSubject(null);setLevel(null);setQuestions([]);go("home");};
  const logout=()=>{setUser(null);go("auth");};
  return (
    <div>
      {screen==="splash"&&<Splash onDone={()=>go("auth")}/>}
      {screen==="auth"&&<Auth onAuth={u=>{setUser(u);go("home");}}/>}
      {screen==="home"&&<Home user={user} onSelectClass={selectClass} onLogout={logout}/>}
      {screen==="stream"&&<StreamSelect cls={cls} onBack={goHome} onSelect={selectStream}/>}
      {screen==="subject"&&<SubjectSelect cls={cls} stream={stream} onBack={()=>go(cls>=11?"stream":"home")} onSelect={selectSubject}/>}
      {screen==="level"&&<LevelSelect cls={cls} subject={subject} onBack={()=>go("subject")} onSelect={selectLevel}/>}
      {screen==="generating"&&<Generating cls={cls} subject={subject} level={level}/>}
      {screen==="exam"&&<Exam questions={questions} cls={cls} subject={subject} level={level} answers={answers} onFinish={finish}/>}
      {screen==="results"&&<Results questions={questions} answers={answers} cls={cls} subject={subject} onHome={goHome} onRetry={retry}/>}
      {["exam","results","home"].includes(screen)&&subject&&<ChatBot subject={subject} cls={cls}/>}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
